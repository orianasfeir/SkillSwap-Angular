{% extends 'base.html' %}

{% block title %}Submit Review - SkillSwap{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8 col-lg-6">
        <div class="card">
            <div class="card-body p-4">
                <h2 class="text-center mb-4">Submit Review</h2>
                
                <div class="text-center mb-4">
                    <h5>{{ skill.title }}</h5>
                    <p class="text-muted">Taught by {{ skill.user.username }}</p>
                </div>
                
                <form method="post" class="needs-validation" novalidate>
                    {% csrf_token %}
                    
                    {% if form.errors %}
                        <div class="alert alert-danger">
                            Please correct the errors below.
                        </div>
                    {% endif %}
                    
                    <div class="mb-4 text-center">
                        <label class="form-label d-block">Rating</label>
                        <div class="rating-input">
                            {% for i in "12345"|make_list %}
                                <input type="radio" 
                                       name="rating" 
                                       id="rating{{ i }}" 
                                       value="{{ i }}" 
                                       class="d-none" 
                                       {% if form.rating.value == i %}checked{% endif %}>
                                <label for="rating{{ i }}" class="rating-star">
                                    <i class="fas fa-star fa-2x"></i>
                                </label>
                            {% endfor %}
                        </div>
                        {% if form.rating.errors %}
                            <div class="invalid-feedback d-block">
                                {{ form.rating.errors.0 }}
                            </div>
                        {% endif %}
                    </div>
                    
                    <div class="mb-4">
                        <label for="id_comment" class="form-label">Review</label>
                        <textarea name="comment" 
                                  id="id_comment" 
                                  class="form-control {% if form.comment.errors %}is-invalid{% endif %}" 
                                  rows="5" 
                                  placeholder="Share your experience learning this skill..."
                                  required>{{ form.comment.value|default:'' }}</textarea>
                        {% if form.comment.errors %}
                            <div class="invalid-feedback">
                                {{ form.comment.errors.0 }}
                            </div>
                        {% endif %}
                    </div>
                    
                    <div class="d-grid gap-2">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-paper-plane me-2"></i>Submit Review
                        </button>
                        <a href="{% url 'skill_detail' skill.id %}" class="btn btn-outline-secondary">
                            <i class="fas fa-times me-2"></i>Cancel
                        </a>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

{% block extra_js %}
<script>
    // Rating input styling
    document.querySelectorAll('.rating-input input').forEach(input => {
        input.addEventListener('change', function() {
            const rating = parseInt(this.value);
            document.querySelectorAll('.rating-input label').forEach((label, index) => {
                if (index < rating) {
                    label.classList.add('text-warning');
                } else {
                    label.classList.remove('text-warning');
                }
            });
        });
    });
    
    // Initialize rating display
    document.querySelectorAll('.rating-input input:checked').forEach(input => {
        const rating = parseInt(input.value);
        document.querySelectorAll('.rating-input label').forEach((label, index) => {
            if (index < rating) {
                label.classList.add('text-warning');
            }
        });
    });
</script>

<style>
    .rating-input {
        display: flex;
        justify-content: center;
        gap: 0.5rem;
    }
    
    .rating-input label {
        cursor: pointer;
        color: var(--dark-text-secondary);
        transition: color 0.2s;
    }
    
    .rating-input label:hover,
    .rating-input label:hover ~ label {
        color: var(--primary-color) !important;
    }
    
    .rating-input input:checked ~ label {
        color: var(--primary-color) !important;
    }
</style>
{% endblock %}
{% endblock %} 